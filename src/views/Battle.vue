<template>
  <PageTitle title="Battle" />

  <div class="flex flex-col justify-center items-center flex-wrap">
    <div class="flex gap-2 w-full p-2 max-w-7xl">
      <div class="w-1/3 p-2">
        <h1 class="text-2xl text-center w-full text-darkgreen mb-2">Turni</h1>

        <div class="scrollable">
          <draggable v-model="turns" tag="ul" :animation="300" v-if="false">
            <template #item="{ element: turn }">
              <li class="relative w-full p-2 mb-1 border-2 rounded-md flex gap-1 justify-between text-white select-none cursor-grab items-center" :class="{ 'border-darkgreen bg-lightgreen': turn.type === 'player', 'border-red-500 bg-red-400': turn.type === 'enemy' }">
                <div class="flex gap-2">
                  <!-- input for initiative -->
                  <input v-model="turn.initiative" class="bg-transparent text-white text-lg w-6 outline-none border-none text-center" />
                  <!-- input for name -->
                  <input v-model="turn.name" class="bg-transparent text-white text-lg outline-none border-none" />
                </div>
                <div class="h-7">
                  <button v-if="turn.dead" class="relative text-white rounded-md px-1 py-1 text-xs font-bold z-10 bg-darkgreen" @click="turn.dead = false">
                    <svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="20" height="20" viewBox="0 0 1280.000000 1280.000000" preserveAspectRatio="xMidYMid meet">
                      <metadata>
                        Created by potrace 1.15, written by Peter Selinger 2001-2017
                      </metadata>
                      <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="#ffffff" stroke="none">
                        <path d="M6055 11684 c-969 -75 -1819 -365 -2600 -889 -301 -201 -533 -393 -795 -655 -267 -267 -456 -498 -665 -810 -475 -712 -749 -1461 -857 -2342 -20 -162 -22 -229 -22 -588 0 -429 10 -570 65 -888 186 -1085 697 -2070 1479 -2852 267 -267 498 -456 810 -665 638 -425 1331 -698 2081 -819 328 -53 427 -60 849 -60 422 0 521 7 849 60 1997 322 3653 1780 4226 3720 89 302 145 576 187 916 20 162 22 229 22 588 0 429 -10 572 -65 888 -125 724 -395 1408 -795 2016 -811 1231 -2096 2071 -3543 2316 -292 49 -440 61 -816 64 -198 2 -382 2 -410 0z m795 -829 c931 -97 1798 -474 2490 -1082 832 -731 1354 -1705 1500 -2795 117 -881 -39 -1792 -444 -2593 -264 -520 -612 -968 -1056 -1358 -1345 -1181 -3290 -1440 -4896 -653 -889 435 -1606 1145 -2048 2027 -635 1265 -632 2750 8 4014 264 520 612 968 1056 1358 670 588 1501 959 2400 1072 293 37 694 41 990 10z" />
                        <path d="M5715 9361 c-48 -22 -79 -54 -100 -103 -13 -33 -15 -158 -15 -1048 l0 -1010 -1012 0 c-963 0 -1015 -1 -1053 -19 -48 -22 -79 -54 -100 -103 -13 -32 -15 -122 -15 -678 0 -556 2 -646 15 -678 21 -49 52 -81 100 -103 38 -18 90 -19 1053 -19 l1012 0 0 -1012 c0 -963 1 -1015 19 -1053 22 -48 54 -79 103 -100 32 -13 122 -15 680 -15 602 0 646 2 683 19 50 22 91 69 105 119 6 24 10 381 10 1040 l0 1002 1010 0 c890 0 1015 2 1048 15 49 21 81 52 103 100 17 38 19 79 19 685 0 604 -2 648 -19 685 -22 50 -69 91 -119 105 -24 6 -381 10 -1039 10 l-1003 0 0 1003 c0 658 -4 1015 -10 1039 -14 50 -55 97 -105 119 -37 17 -81 19 -685 19 -606 0 -647 -2 -685 -19z" />
                      </g>
                    </svg>
                  </button>
                  <button class="relative text-white ml-1 rounded-md px-1 py-1 text-xs font-bold cursor-pointer z-10" :class="{ 'bg-darkgreen': turn.type === 'player', 'bg-red-700': turn.type === 'enemy' }" @click="kill(turn)">
                    <svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="20" height="20" viewBox="0 0 862.000000 1280.000000" preserveAspectRatio="xMidYMid meet">
                      <metadata>
                        Created by potrace 1.15, written by Peter Selinger 2001-2017
                      </metadata>
                      <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="#ffffff" stroke="none">
                        <path d="M4270 12770 c-118 -16 -314 -35 -435 -44 -965 -71 -1260 -141 -1790 -425 -381 -203 -634 -415 -1033 -865 -224 -251 -302 -349 -411 -511 -333 -497 -507 -1003 -583 -1695 -19 -174 -16 -706 6 -915 93 -921 234 -1332 563 -1638 l51 -48 17 58 c27 92 52 229 64 347 15 152 13 552 -4 921 -17 360 -19 632 -5 762 20 186 97 377 327 813 82 157 156 303 163 325 91 287 224 538 359 678 80 83 231 190 247 174 10 -9 -50 -149 -130 -302 -118 -227 -126 -248 -227 -617 -100 -367 -110 -392 -252 -617 -49 -79 -105 -178 -125 -219 -119 -258 -152 -667 -132 -1627 14 -688 9 -723 -102 -858 -48 -56 -131 -99 -288 -147 -195 -59 -282 -121 -339 -240 -25 -53 -26 -61 -26 -241 l0 -187 44 -83 c92 -178 207 -301 390 -421 184 -120 377 -206 896 -399 345 -128 426 -169 548 -276 86 -76 143 -149 250 -322 126 -203 243 -329 407 -438 152 -101 247 -145 445 -202 410 -119 1132 -165 1803 -115 l93 7 -6 -39 c-3 -21 -12 -98 -20 -171 -23 -220 7 -405 79 -489 33 -38 36 -39 98 -39 53 0 72 5 106 27 35 24 44 37 61 93 38 122 55 235 55 374 l1 133 -39 34 c-49 43 -99 61 -211 77 l-90 13 55 12 c30 6 125 24 211 41 190 37 219 46 386 128 215 106 292 177 518 473 154 203 228 285 333 370 109 88 172 118 458 220 511 182 742 297 936 467 113 99 259 279 302 373 57 125 77 319 42 420 -24 68 -99 146 -182 188 -32 16 -124 53 -204 82 -181 65 -250 101 -315 165 -67 65 -91 129 -105 277 -22 230 33 751 131 1237 l11 54 64 -64 64 -63 0 -265 c0 -222 5 -312 31 -570 17 -168 32 -308 34 -310 10 -10 158 37 228 71 175 88 298 256 366 498 45 164 57 259 100 790 52 635 56 707 55 1075 0 306 -3 386 -22 535 -68 555 -217 962 -519 1417 -239 360 -489 628 -848 909 -519 406 -1090 675 -1639 774 -91 17 -154 20 -377 20 -244 0 -285 3 -474 30 -114 17 -217 29 -229 29 -11 -1 -118 -14 -236 -29z m-1403 -4351 c230 -31 450 -127 600 -263 122 -110 220 -283 254 -451 44 -213 4 -497 -97 -683 -221 -409 -580 -718 -1024 -882 -210 -78 -378 -98 -532 -65 -222 46 -376 209 -441 462 -20 81 -22 110 -21 363 0 299 13 437 60 629 105 443 362 718 805 866 92 30 117 34 211 35 59 0 142 -5 185 -11z m3233 -15 c478 -89 816 -552 870 -1195 6 -68 22 -190 35 -270 29 -173 30 -192 9 -273 -32 -124 -106 -245 -216 -353 -91 -90 -158 -137 -283 -199 -144 -70 -266 -106 -365 -105 -526 4 -1237 790 -1305 1442 -16 149 64 354 201 516 163 193 392 329 729 429 120 37 167 38 325 8z m-1758 -1813 c65 -25 120 -121 139 -241 14 -94 34 -176 115 -469 108 -387 152 -590 173 -781 20 -190 21 -210 11 -210 -6 0 -147 25 -313 55 l-302 55 -251 -84 -252 -84 -7 72 c-23 248 86 750 255 1176 83 211 219 437 294 492 41 29 92 37 138 19z" />
                        <path d="M1364 4030 c-49 -32 -69 -89 -68 -195 1 -91 55 -1232 74 -1555 24 -430 90 -591 368 -903 209 -234 256 -294 390 -497 74 -112 162 -241 196 -285 137 -180 301 -324 459 -404 143 -71 452 -143 747 -173 159 -16 666 -16 820 1 67 7 231 12 391 11 290 -1 407 10 539 49 275 80 490 228 753 516 346 380 660 853 782 1180 l37 100 29 405 c15 223 33 434 40 470 6 36 36 162 66 280 69 274 80 335 93 500 12 158 13 410 2 410 -4 0 -23 -5 -42 -10 -19 -6 -111 -26 -204 -46 -254 -52 -358 -98 -473 -207 -108 -101 -194 -250 -252 -431 -44 -135 -62 -219 -116 -521 -55 -311 -83 -433 -132 -580 -91 -277 -225 -484 -388 -600 -183 -130 -467 -223 -785 -256 -147 -15 -704 -6 -890 15 -332 38 -563 96 -779 197 -283 133 -470 320 -610 609 -85 175 -100 266 -121 715 -6 121 -17 252 -24 291 -34 168 -95 318 -185 453 -63 95 -186 238 -220 255 -15 8 -76 49 -136 91 -151 106 -211 135 -277 135 -36 0 -63 -7 -84 -20z" />
                        <path d="M2977 3400 c-34 -10 -100 -59 -127 -93 -60 -75 -80 -178 -56 -281 48 -204 201 -354 339 -331 52 9 119 70 152 140 22 47 25 67 25 157 0 158 -40 358 -80 398 -17 17 -33 20 -122 19 -57 0 -115 -4 -131 -9z" />
                        <path d="M4010 3335 c-19 -9 -43 -24 -53 -33 -34 -30 -76 -128 -94 -219 l-18 -88 -6 65 c-8 80 -36 145 -85 200 -56 62 -104 83 -179 78 -69 -4 -123 -35 -149 -87 -26 -50 -46 -192 -53 -371 l-6 -177 54 -19 c74 -26 235 -26 347 0 l82 19 1 76 c1 67 2 72 10 38 20 -84 83 -169 137 -185 15 -4 65 -7 112 -7 99 0 149 21 199 82 55 67 64 114 58 307 -4 138 -9 184 -26 236 -32 100 -23 95 -168 98 -98 1 -136 -2 -163 -13z" />
                        <path d="M4495 3337 c-7 -22 -54 -369 -66 -486 -6 -63 -8 -134 -4 -158 6 -39 11 -46 42 -60 87 -36 276 -25 382 23 l54 24 -6 213 c-11 362 -32 401 -232 432 -164 25 -166 25 -170 12z" />
                        <path d="M2843 1979 c7 -152 34 -273 73 -332 35 -54 112 -87 212 -94 82 -6 151 7 177 33 46 47 -21 292 -108 391 -47 54 -131 90 -262 113 -33 6 -69 14 -79 17 -18 5 -19 0 -13 -128z" />
                        <path d="M3500 2067 c-3 -3 -45 -10 -93 -15 -49 -5 -91 -12 -94 -16 -3 -3 11 -90 31 -193 61 -315 135 -424 270 -399 107 20 207 232 192 410 -11 145 -74 205 -225 214 -42 2 -78 2 -81 -1z" />
                        <path d="M4847 2026 c-48 -18 -83 -49 -110 -101 -19 -34 -22 -56 -21 -140 1 -83 6 -116 32 -195 45 -138 91 -200 148 -200 60 0 217 152 267 258 52 111 39 209 -40 293 -73 78 -194 115 -276 85z" />
                        <path d="M3984 1939 c-91 -87 -132 -208 -113 -333 25 -153 126 -235 279 -224 85 6 121 28 170 101 62 93 83 158 84 262 1 81 -2 94 -26 131 -15 23 -40 51 -55 62 -43 31 -129 52 -210 52 l-74 0 -55 -51z" />
                      </g>
                    </svg>
                  </button>
                </div>

                <div v-if="turn.dead" class="absolute h-1 left-0 w-full bg-darkgreen"></div>
              </li>
            </template>
          </draggable>
          <ul>
            <li v-for="turn in turns" class="relative w-full p-2 mb-1 border-2 rounded-md flex gap-1 justify-between text-white select-none cursor-grab items-center" :class="{ 'border-darkgreen bg-lightgreen': turn.type === 'player', 'border-red-500 bg-red-400': turn.type === 'enemy' }">
                <div class="flex gap-2">
                  <!-- input for initiative -->
                  <input v-model="turn.initiative" @change="sortTurns" class="bg-transparent text-white text-lg w-6 outline-none border-none text-center" />
                  <!-- input for name -->
                  <input v-model="turn.name" class="bg-transparent text-white text-lg outline-none border-none" />
                </div>
                <div class="h-7">
                  <button v-if="turn.dead" class="relative text-white rounded-md px-1 py-1 text-xs font-bold z-10 bg-darkgreen" @click="turn.dead = false">
                    <svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="20" height="20" viewBox="0 0 1280.000000 1280.000000" preserveAspectRatio="xMidYMid meet">
                      <metadata>
                        Created by potrace 1.15, written by Peter Selinger 2001-2017
                      </metadata>
                      <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="#ffffff" stroke="none">
                        <path d="M6055 11684 c-969 -75 -1819 -365 -2600 -889 -301 -201 -533 -393 -795 -655 -267 -267 -456 -498 -665 -810 -475 -712 -749 -1461 -857 -2342 -20 -162 -22 -229 -22 -588 0 -429 10 -570 65 -888 186 -1085 697 -2070 1479 -2852 267 -267 498 -456 810 -665 638 -425 1331 -698 2081 -819 328 -53 427 -60 849 -60 422 0 521 7 849 60 1997 322 3653 1780 4226 3720 89 302 145 576 187 916 20 162 22 229 22 588 0 429 -10 572 -65 888 -125 724 -395 1408 -795 2016 -811 1231 -2096 2071 -3543 2316 -292 49 -440 61 -816 64 -198 2 -382 2 -410 0z m795 -829 c931 -97 1798 -474 2490 -1082 832 -731 1354 -1705 1500 -2795 117 -881 -39 -1792 -444 -2593 -264 -520 -612 -968 -1056 -1358 -1345 -1181 -3290 -1440 -4896 -653 -889 435 -1606 1145 -2048 2027 -635 1265 -632 2750 8 4014 264 520 612 968 1056 1358 670 588 1501 959 2400 1072 293 37 694 41 990 10z" />
                        <path d="M5715 9361 c-48 -22 -79 -54 -100 -103 -13 -33 -15 -158 -15 -1048 l0 -1010 -1012 0 c-963 0 -1015 -1 -1053 -19 -48 -22 -79 -54 -100 -103 -13 -32 -15 -122 -15 -678 0 -556 2 -646 15 -678 21 -49 52 -81 100 -103 38 -18 90 -19 1053 -19 l1012 0 0 -1012 c0 -963 1 -1015 19 -1053 22 -48 54 -79 103 -100 32 -13 122 -15 680 -15 602 0 646 2 683 19 50 22 91 69 105 119 6 24 10 381 10 1040 l0 1002 1010 0 c890 0 1015 2 1048 15 49 21 81 52 103 100 17 38 19 79 19 685 0 604 -2 648 -19 685 -22 50 -69 91 -119 105 -24 6 -381 10 -1039 10 l-1003 0 0 1003 c0 658 -4 1015 -10 1039 -14 50 -55 97 -105 119 -37 17 -81 19 -685 19 -606 0 -647 -2 -685 -19z" />
                      </g>
                    </svg>
                  </button>
                  <button class="relative text-white ml-1 rounded-md px-1 py-1 text-xs font-bold cursor-pointer z-10" :class="{ 'bg-darkgreen': turn.type === 'player', 'bg-red-700': turn.type === 'enemy' }" @click="kill(turn)">
                    <svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="20" height="20" viewBox="0 0 862.000000 1280.000000" preserveAspectRatio="xMidYMid meet">
                      <metadata>
                        Created by potrace 1.15, written by Peter Selinger 2001-2017
                      </metadata>
                      <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="#ffffff" stroke="none">
                        <path d="M4270 12770 c-118 -16 -314 -35 -435 -44 -965 -71 -1260 -141 -1790 -425 -381 -203 -634 -415 -1033 -865 -224 -251 -302 -349 -411 -511 -333 -497 -507 -1003 -583 -1695 -19 -174 -16 -706 6 -915 93 -921 234 -1332 563 -1638 l51 -48 17 58 c27 92 52 229 64 347 15 152 13 552 -4 921 -17 360 -19 632 -5 762 20 186 97 377 327 813 82 157 156 303 163 325 91 287 224 538 359 678 80 83 231 190 247 174 10 -9 -50 -149 -130 -302 -118 -227 -126 -248 -227 -617 -100 -367 -110 -392 -252 -617 -49 -79 -105 -178 -125 -219 -119 -258 -152 -667 -132 -1627 14 -688 9 -723 -102 -858 -48 -56 -131 -99 -288 -147 -195 -59 -282 -121 -339 -240 -25 -53 -26 -61 -26 -241 l0 -187 44 -83 c92 -178 207 -301 390 -421 184 -120 377 -206 896 -399 345 -128 426 -169 548 -276 86 -76 143 -149 250 -322 126 -203 243 -329 407 -438 152 -101 247 -145 445 -202 410 -119 1132 -165 1803 -115 l93 7 -6 -39 c-3 -21 -12 -98 -20 -171 -23 -220 7 -405 79 -489 33 -38 36 -39 98 -39 53 0 72 5 106 27 35 24 44 37 61 93 38 122 55 235 55 374 l1 133 -39 34 c-49 43 -99 61 -211 77 l-90 13 55 12 c30 6 125 24 211 41 190 37 219 46 386 128 215 106 292 177 518 473 154 203 228 285 333 370 109 88 172 118 458 220 511 182 742 297 936 467 113 99 259 279 302 373 57 125 77 319 42 420 -24 68 -99 146 -182 188 -32 16 -124 53 -204 82 -181 65 -250 101 -315 165 -67 65 -91 129 -105 277 -22 230 33 751 131 1237 l11 54 64 -64 64 -63 0 -265 c0 -222 5 -312 31 -570 17 -168 32 -308 34 -310 10 -10 158 37 228 71 175 88 298 256 366 498 45 164 57 259 100 790 52 635 56 707 55 1075 0 306 -3 386 -22 535 -68 555 -217 962 -519 1417 -239 360 -489 628 -848 909 -519 406 -1090 675 -1639 774 -91 17 -154 20 -377 20 -244 0 -285 3 -474 30 -114 17 -217 29 -229 29 -11 -1 -118 -14 -236 -29z m-1403 -4351 c230 -31 450 -127 600 -263 122 -110 220 -283 254 -451 44 -213 4 -497 -97 -683 -221 -409 -580 -718 -1024 -882 -210 -78 -378 -98 -532 -65 -222 46 -376 209 -441 462 -20 81 -22 110 -21 363 0 299 13 437 60 629 105 443 362 718 805 866 92 30 117 34 211 35 59 0 142 -5 185 -11z m3233 -15 c478 -89 816 -552 870 -1195 6 -68 22 -190 35 -270 29 -173 30 -192 9 -273 -32 -124 -106 -245 -216 -353 -91 -90 -158 -137 -283 -199 -144 -70 -266 -106 -365 -105 -526 4 -1237 790 -1305 1442 -16 149 64 354 201 516 163 193 392 329 729 429 120 37 167 38 325 8z m-1758 -1813 c65 -25 120 -121 139 -241 14 -94 34 -176 115 -469 108 -387 152 -590 173 -781 20 -190 21 -210 11 -210 -6 0 -147 25 -313 55 l-302 55 -251 -84 -252 -84 -7 72 c-23 248 86 750 255 1176 83 211 219 437 294 492 41 29 92 37 138 19z" />
                        <path d="M1364 4030 c-49 -32 -69 -89 -68 -195 1 -91 55 -1232 74 -1555 24 -430 90 -591 368 -903 209 -234 256 -294 390 -497 74 -112 162 -241 196 -285 137 -180 301 -324 459 -404 143 -71 452 -143 747 -173 159 -16 666 -16 820 1 67 7 231 12 391 11 290 -1 407 10 539 49 275 80 490 228 753 516 346 380 660 853 782 1180 l37 100 29 405 c15 223 33 434 40 470 6 36 36 162 66 280 69 274 80 335 93 500 12 158 13 410 2 410 -4 0 -23 -5 -42 -10 -19 -6 -111 -26 -204 -46 -254 -52 -358 -98 -473 -207 -108 -101 -194 -250 -252 -431 -44 -135 -62 -219 -116 -521 -55 -311 -83 -433 -132 -580 -91 -277 -225 -484 -388 -600 -183 -130 -467 -223 -785 -256 -147 -15 -704 -6 -890 15 -332 38 -563 96 -779 197 -283 133 -470 320 -610 609 -85 175 -100 266 -121 715 -6 121 -17 252 -24 291 -34 168 -95 318 -185 453 -63 95 -186 238 -220 255 -15 8 -76 49 -136 91 -151 106 -211 135 -277 135 -36 0 -63 -7 -84 -20z" />
                        <path d="M2977 3400 c-34 -10 -100 -59 -127 -93 -60 -75 -80 -178 -56 -281 48 -204 201 -354 339 -331 52 9 119 70 152 140 22 47 25 67 25 157 0 158 -40 358 -80 398 -17 17 -33 20 -122 19 -57 0 -115 -4 -131 -9z" />
                        <path d="M4010 3335 c-19 -9 -43 -24 -53 -33 -34 -30 -76 -128 -94 -219 l-18 -88 -6 65 c-8 80 -36 145 -85 200 -56 62 -104 83 -179 78 -69 -4 -123 -35 -149 -87 -26 -50 -46 -192 -53 -371 l-6 -177 54 -19 c74 -26 235 -26 347 0 l82 19 1 76 c1 67 2 72 10 38 20 -84 83 -169 137 -185 15 -4 65 -7 112 -7 99 0 149 21 199 82 55 67 64 114 58 307 -4 138 -9 184 -26 236 -32 100 -23 95 -168 98 -98 1 -136 -2 -163 -13z" />
                        <path d="M4495 3337 c-7 -22 -54 -369 -66 -486 -6 -63 -8 -134 -4 -158 6 -39 11 -46 42 -60 87 -36 276 -25 382 23 l54 24 -6 213 c-11 362 -32 401 -232 432 -164 25 -166 25 -170 12z" />
                        <path d="M2843 1979 c7 -152 34 -273 73 -332 35 -54 112 -87 212 -94 82 -6 151 7 177 33 46 47 -21 292 -108 391 -47 54 -131 90 -262 113 -33 6 -69 14 -79 17 -18 5 -19 0 -13 -128z" />
                        <path d="M3500 2067 c-3 -3 -45 -10 -93 -15 -49 -5 -91 -12 -94 -16 -3 -3 11 -90 31 -193 61 -315 135 -424 270 -399 107 20 207 232 192 410 -11 145 -74 205 -225 214 -42 2 -78 2 -81 -1z" />
                        <path d="M4847 2026 c-48 -18 -83 -49 -110 -101 -19 -34 -22 -56 -21 -140 1 -83 6 -116 32 -195 45 -138 91 -200 148 -200 60 0 217 152 267 258 52 111 39 209 -40 293 -73 78 -194 115 -276 85z" />
                        <path d="M3984 1939 c-91 -87 -132 -208 -113 -333 25 -153 126 -235 279 -224 85 6 121 28 170 101 62 93 83 158 84 262 1 81 -2 94 -26 131 -15 23 -40 51 -55 62 -43 31 -129 52 -210 52 l-74 0 -55 -51z" />
                      </g>
                    </svg>
                  </button>
                </div>

                <div v-if="turn.dead" class="absolute h-1 left-0 w-full bg-darkgreen"></div>
            </li>
          </ul>
        </div>
        <div class="flex gap-1 justify-between items-center mt-5">
          <button class="py-2 px-4 text-white uppercase bg-lightgreen rounded-md hover:bg-darkgreen border-2 border-darkgreen" @click="addPlayer">player</button>
          <div class="uppercase text-stone-500">⇠ add ⇢</div>
          <button class="py-2 px-4 text-white uppercase bg-red-400 rounded-md hover:bg-red-500 border-2 border-red-500" @click="addEnemy">enemy</button>
        </div>

      </div>
      <div class="border border-darkgreen w-2/3 p-2">
        mappa
      </div>
    </div>
  </div>
</template>

<script setup>
import { onMounted, ref, nextTick } from 'vue'
import draggable from 'vuedraggable';

const turns = ref([])

onMounted(() => {
  const players = ['Thorn', 'Potus', 'Dorean', 'Primus'] // get players from store after players page
  for (let i = 0; i < players.length; i++) {
    turns.value.push({
      name: players[i],
      type: 'player',
      dead: false,
      initiative: 0,
    })
  }
})

/**
 * Removes a turn from the turns list and marks it as dead if it's a player turn.
 * @param {Object} turn - The turn object to process.
 * @param {string} turn.type - The type of turn ('player' or other).
 * @param {boolean} [turn.dead] - Indicates if turn are already dead.
 */
const kill = (turn) => {
  // If the turn type is 'player'
  if (turn.type === 'player') {
    // Check if the turns are already dead
    if (turn.dead) {
      // Find the index of the current turn in turns.value and remove it
      turns.value = turns.value.filter(t => t !== turn);
    }
    // Mark the current turn as dead
    turn.dead = true;
  } else {
    // If the turn type is not 'player', simply remove it from turns.value
    turns.value = turns.value.filter(t => t !== turn);
  }
}

const addPlayer = () => {
  turns.value.push({
    name: 'New Player',
    type: 'player',
    dead: false,
    initiative: 0,
  })
  focusOnNewInput()
}

const addEnemy = () => {
  turns.value.push({
    name: 'New Enemy',
    type: 'enemy',
    dead: false,
    initiative: 0,
  })
  focusOnNewInput()
}

const focusOnNewInput = () => {
  // focus on its input initiative
  nextTick(() => {
    const inputs = document.querySelectorAll('input')
    inputs[inputs.length - 2].focus()
    inputs[inputs.length - 2].select()
  })
}

const sortTurns = () => {
  turns.value = turns.value.sort((a, b) => b.initiative - a.initiative)
}
</script>

<style scoped>
.scrollable {
  height: calc(100vh - 350px);
  overflow: auto;
}
</style>